Класс Василия Наумкина - https://gist.github.com/bezumkin/4243590
Пришлось его чуточку поправить на 15 строчке, чтобы папки создавал рекурсивно.
Возможно на данный момент это изменение уже внесено в офф версию класса.